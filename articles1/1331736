Path: news.gmane.org!not-for-mail
From: Thierry Reding <thierry.reding@avionic-design.de>
Newsgroups: gmane.linux.kernel,gmane.linux.ports.arm.omap
Subject: Re: [PATCH] PWM: Add support for configuring polarity of PWM
Date: Mon, 23 Jul 2012 15:08:25 +0200
Lines: 78
Approved: news@gmane.org
Message-ID: <20120723130825.GA21254@avionic-0098.mockup.avionic-design.de>
References: <1342616053-7793-1-git-send-email-avinashphilip@ti.com>
 <20120723083032.GA12868@avionic-0098.mockup.avionic-design.de>
 <518397C60809E147AF5323E0420B992E3E97189D@DBDE01.ent.ti.com>
NNTP-Posting-Host: plane.gmane.org
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="3MwIy2ne0vdjdPXF"
X-Trace: dough.gmane.org 1343048924 4867 80.91.229.3 (23 Jul 2012 13:08:44 GMT)
X-Complaints-To: usenet@dough.gmane.org
NNTP-Posting-Date: Mon, 23 Jul 2012 13:08:44 +0000 (UTC)
Cc: "linux-kernel@vger.kernel.org" <linux-kernel@vger.kernel.org>,
	"linux-omap@vger.kernel.org" <linux-omap@vger.kernel.org>,
	"Nori, Sekhar" <nsekhar@ti.com>,
	"Hebbar, Gururaja" <gururaja.hebbar@ti.com>
To: "Philip, Avinash" <avinashphilip@ti.com>
Original-X-From: linux-kernel-owner@vger.kernel.org Mon Jul 23 15:08:37 2012
Return-path: <linux-kernel-owner@vger.kernel.org>
Envelope-to: glk-linux-kernel-3@plane.gmane.org
Original-Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <linux-kernel-owner@vger.kernel.org>)
	id 1StINJ-0000KJ-Dx
	for glk-linux-kernel-3@plane.gmane.org; Mon, 23 Jul 2012 15:08:37 +0200
Original-Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753279Ab2GWNIa (ORCPT <rfc822;glk-linux-kernel-3@m.gmane.org>);
	Mon, 23 Jul 2012 09:08:30 -0400
Original-Received: from moutng.kundenserver.de ([212.227.17.9]:57287 "EHLO
	moutng.kundenserver.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752271Ab2GWNI2 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Mon, 23 Jul 2012 09:08:28 -0400
Original-Received: from mailbox.adnet.avionic-design.de (mailbox.avionic-design.de [109.75.18.3])
	by mrelayeu.kundenserver.de (node=mrbap3) with ESMTP (Nemesis)
	id 0MVuWW-1TLrr10FDM-00X6VI; Mon, 23 Jul 2012 15:08:27 +0200
Original-Received: from localhost (localhost [127.0.0.1])
	by mailbox.adnet.avionic-design.de (Postfix) with ESMTP id 80E6F2A28306;
	Mon, 23 Jul 2012 15:08:26 +0200 (CEST)
X-Virus-Scanned: amavisd-new at avionic-design.de
Original-Received: from mailbox.adnet.avionic-design.de ([127.0.0.1])
	by localhost (mailbox.avionic-design.de [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 6wUtjIBxuS6l; Mon, 23 Jul 2012 15:08:25 +0200 (CEST)
Original-Received: from localhost (avionic-0098.adnet.avionic-design.de [172.20.31.233])
	(Authenticated sender: thierry.reding)
	by mailbox.adnet.avionic-design.de (Postfix) with ESMTPA id A19EE2A2816F;
	Mon, 23 Jul 2012 15:08:25 +0200 (CEST)
Content-Disposition: inline
In-Reply-To: <518397C60809E147AF5323E0420B992E3E97189D@DBDE01.ent.ti.com>
User-Agent: Mutt/1.5.21 (2010-09-15)
X-Provags-ID: V02:K0:3fNJXJleFBRc6ZLgsWy4sPvgUB/ZwHMAIWxtEbHqhlI
 TYwFV9slgM7on8tCDlp0ZKkGBnYz6zrCTY5OUe+X8MGHFA9yjY
 kKlpC3lfAa8uLB0Xsxgi082z2MSPBrkjh1KOSGyfnjI/0XNYqM
 PiP/N4VAASyg09e1ltnHsxPGme6i19Zm6NsB91VpkBpv8SRN2l
 xMsWU9yqhY1mnQoXe4UaQ2BlLdkyEMaFcb8izHVdAlUN1g1Uy+
 2HptoR9JWUScd7mmcbubcQ6dztcqY52OlmtQBXBmezULW0Z64d
 +v//AkcrS4rwCv0l3xYVl+5A3giqUo6KJvV+6jcsv82qkLdvSA
 51/5wVB/itxzTKe8EwLiVtC5H6OveTvM0+mJzMtsm8nqhLaRc2
 O9N3cmuJ6C1kYbMryIc6LrXKokKfS4JfvgLg3RZcPjKnTySXRo
 Z2zmi
Original-Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
Xref: news.gmane.org gmane.linux.kernel:1331736 gmane.linux.ports.arm.omap:81225
Archived-At: <http://permalink.gmane.org/gmane.linux.kernel/1331736>


--3MwIy2ne0vdjdPXF
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Mon, Jul 23, 2012 at 12:51:11PM +0000, Philip, Avinash wrote:
> On Mon, Jul 23, 2012 at 14:00:32, Thierry Reding wrote:
> > On Wed, Jul 18, 2012 at 06:24:13PM +0530, Philip, Avinash wrote:
[...]
> > > +
> > > +	if (test_bit(PWMF_ENABLED, &pwm->flags)) {
> > > +		dev_err(pwm->chip->dev,
> > > +			"Polarity configuration Failed!, PWM device enabled\n");
> > > +		return -EBUSY;
> > > +	}
> >=20
> > Maybe something like: "polarity cannot be configured while PWM device is
> > enabled"?
>=20
> Ok I will update.
>=20
> > Though I'm not sure the error message is all that useful. I'd
> > expect the user driver to handle -EBUSY specially.
>=20
> On EBUSY, client driver has to rework on it. Nothing to be done from
> framework

Exactly, so I think that if an error is displayed because the PWM has
been enabled, then that client (=3D=3D user) driver should output an error
message, not the framework. Also, it really shouldn't happen because it
clearly is a driver problem that needs to be fixed.

> > >  /*
> > >   * pwm_enable - start a PWM output toggling
> > >   */
> > > @@ -37,6 +47,7 @@ struct pwm_chip;
> > >  enum {
> > >  	PWMF_REQUESTED =3D 1 << 0,
> > >  	PWMF_ENABLED =3D 1 << 1,
> > > +	PWMF_POLARITY_INVERSE =3D 1 << 2,
> >=20
> > This should be named PWMF_POLARITY_INVERSED for consistency.
>=20
> Ok I will correct it.
>=20
> > I'm not sure that we really need this flag, though. It isn't used anywh=
ere. But
> > maybe you have a use-case in mind?
>=20
> It can be used to find the polarity of the PWM at runtime.

Yes, but is there any use-case where this information would be required?

Thierry

--3MwIy2ne0vdjdPXF
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.19 (GNU/Linux)

iQIcBAEBAgAGBQJQDUzJAAoJEN0jrNd/PrOhlMUP/RRHqEdxWyFUNGT8MT4eVhx+
k3Y+E6v75hHUuPDp8KGDAktIRmuk6vzu4BB3QT1zvCIbdWLxKS701M4zn+yUeYWM
MsCaByd9mcvO+RMGEDfsvjPUtg01BEjLS/zTPhSNQAzYjA7yhmoLCZt177X9xi7a
ad3M2Gr0CW47qLhr3R/DzG6gM1NB3JoByjiKsgM9ZddbpFeYwKsq3UrjUj3z0XQw
X0Y7+mHj9yIHIGbTKn3KXp/gjB2B77272cjJ0tR+5U5A1ZQcNL2edDKOgXGT7Ies
pViXdrML0O++Bjeqjk+0zp+Dh62y0DuDb+Iyu+FVIUwXY/YYX+KWs1ayohSZ3sHv
pTY7XrisycBWEpt7WsyVgvRcO3YU9htJOR29km6Wv89rLHcfeNk0+2QwlnqWtdaT
UpANvzAXKnMeV4UWqY0z629DCxThkQXNsMKNx54JQ7r2bfuJc8belsvzbU2e00Rh
pmp1lHvUh2HZmLEMEz4cFgEdc9AKyn4z1Y4KhKPoNrhiBrXzw7b9aTUaa5WMQF85
yYXPG8VxZsKFJJn+7LXjoqiuAC2ExUYREOjPK0KXGP4HEAQu3Uhsyf41r23FgvHT
GnHwrAVlKLOFy/Uk7NmGgCGeXYezHVHv6IZQd41EznUQqmi2Y9Sz7atmC9SdDTTo
yOViLeGuZI4JS9Z3GN3X
=E2wi
-----END PGP SIGNATURE-----

--3MwIy2ne0vdjdPXF--
