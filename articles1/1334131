Path: news.gmane.org!not-for-mail
From: Thierry Reding <thierry.reding@avionic-design.de>
Newsgroups: gmane.linux.kernel
Subject: Re: Oops after merge of tty-next
Date: Fri, 27 Jul 2012 09:16:34 +0200
Lines: 59
Approved: news@gmane.org
Message-ID: <20120727071634.GA29885@avionic-0098.mockup.avionic-design.de>
References: <5009D68A.3050301@mev.co.uk>
 <20120721234145.354e6ee9@pyramind.ukuu.org.uk>
 <500D64D7.3060902@mev.co.uk>
 <20120724230527.2135198e@bob.linux.org.uk>
NNTP-Posting-Host: plane.gmane.org
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="wac7ysb48OaltWcw"
X-Trace: dough.gmane.org 1343373430 31100 80.91.229.3 (27 Jul 2012 07:17:10 GMT)
X-Complaints-To: usenet@dough.gmane.org
NNTP-Posting-Date: Fri, 27 Jul 2012 07:17:10 +0000 (UTC)
Cc: Ian Abbott <abbotti@mev.co.uk>,
	Alan Cox <alan@lxorguk.ukuu.org.uk>,
	Ian Abbott <ian.abbott@mev.co.uk>,
	lkml <linux-kernel@vger.kernel.org>,
	Greg KH <gregkh@linuxfoundation.org>
To: Alan Cox <alan@linux.intel.com>
Original-X-From: linux-kernel-owner@vger.kernel.org Fri Jul 27 09:17:06 2012
Return-path: <linux-kernel-owner@vger.kernel.org>
Envelope-to: glk-linux-kernel-3@plane.gmane.org
Original-Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <linux-kernel-owner@vger.kernel.org>)
	id 1SuenI-0002V2-Ma
	for glk-linux-kernel-3@plane.gmane.org; Fri, 27 Jul 2012 09:17:05 +0200
Original-Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1752376Ab2G0HQk (ORCPT <rfc822;glk-linux-kernel-3@m.gmane.org>);
	Fri, 27 Jul 2012 03:16:40 -0400
Original-Received: from moutng.kundenserver.de ([212.227.17.10]:62460 "EHLO
	moutng.kundenserver.de" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1752128Ab2G0HQi (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Fri, 27 Jul 2012 03:16:38 -0400
Original-Received: from mailbox.adnet.avionic-design.de (mailbox.avionic-design.de [109.75.18.3])
	by mrelayeu.kundenserver.de (node=mrbap4) with ESMTP (Nemesis)
	id 0LqD3Y-1TPbsq3oK8-00dk7E; Fri, 27 Jul 2012 09:16:37 +0200
Original-Received: from localhost (localhost [127.0.0.1])
	by mailbox.adnet.avionic-design.de (Postfix) with ESMTP id 5B68A2A282E5;
	Fri, 27 Jul 2012 09:16:36 +0200 (CEST)
X-Virus-Scanned: amavisd-new at avionic-design.de
Original-Received: from mailbox.adnet.avionic-design.de ([127.0.0.1])
	by localhost (mailbox.avionic-design.de [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id C915EjiNfbnz; Fri, 27 Jul 2012 09:16:35 +0200 (CEST)
Original-Received: from localhost (avionic-0098.adnet.avionic-design.de [172.20.31.233])
	(Authenticated sender: thierry.reding)
	by mailbox.adnet.avionic-design.de (Postfix) with ESMTPA id 48C812A280F7;
	Fri, 27 Jul 2012 09:16:35 +0200 (CEST)
Content-Disposition: inline
In-Reply-To: <20120724230527.2135198e@bob.linux.org.uk>
User-Agent: Mutt/1.5.21 (2010-09-15)
X-Provags-ID: V02:K0:/GCp25m2hIOWTygq1eiozXxw1qZV5yRDYUG1X1Ij/VU
 5QYKCCRs6LhKMreQaB4hId57yBXprhc42h+2DU1ECgds48ExbZ
 LsIfgoSXtPcc77SGuSzM1P+gS7rZHnag8i4/6/hGRHHoEAE4DS
 UpoMRt7orJD2UYaZoZDl9AhQivcaqHQPC0xznrfIMyh6dX0g3D
 4VzXyxljkVGvRn41NPR7GiiPBXFBXM4Dfb7shrWuckIHGxZq+P
 7PwlGcZfflHqu/DUnfR6asd8eVdp27FAt3HtRgkceOeMewBAU4
 Nqqz+rcXnehQfDy//RhufEpjOeRqlWJg4CIS7cvf/moXGx5zdq
 GrO9CXfEg3ddGYtF3oNhZ+ZvRk7drCq21x6zcp+ZtvkDdMKvXt
 EXEBoYS+uicWum6ras2JmA3Q5zWRtCQku8q7/nRm6zgD364pZT
 Z/dH7
Original-Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
Xref: news.gmane.org gmane.linux.kernel:1334131
Archived-At: <http://permalink.gmane.org/gmane.linux.kernel/1334131>


--wac7ysb48OaltWcw
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

On Tue, Jul 24, 2012 at 11:05:27PM +0100, Alan Cox wrote:
> On Mon, 23 Jul 2012 15:51:03 +0100
> Ian Abbott <abbotti@mev.co.uk> wrote:
>=20
> > On 2012-07-21 23:41, Alan Cox wrote:
> > > On Fri, 20 Jul 2012 23:07:06 +0100
> > > Ian Abbott <abbotti@mev.co.uk> wrote:
> > >
> > >> I'm getting an Oops in the linux-next tree today after the merge
> > >> of the remote-tracking branch 'tty/tty-next'.  I bisected it down
> > >> to commit 36b3c070d2346c890d690d71f6eab02f8c511137 in
> > >> git://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git :
>=20
> Ok Greg you can you leave that one in -next but not push it for 3.6.
>=20
> I need to go over this in some detail and figure out the remaining
> race, and worse yet how to fix it without the mess of existing locks
> turning it into something nasty.
>=20
> I think I understand what is needed but I don't want to be doing it as
> a mad panic for 3.6. On the bright side I think it explains the other
> tty lock splitting mysteries.

I've also been able to reproduce this, or at least a very similar issue,
on ARM (Tegra). The system boots into the initrd, which works as usual,
but it hangs when executing the switch_root that starts systemd within
the final root filesystem. With the above-mentioned commit reverted, the
system successfully boots to the login prompt.

Thierry

--wac7ysb48OaltWcw
Content-Type: application/pgp-signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.0.19 (GNU/Linux)

iQIcBAEBAgAGBQJQEkBSAAoJEN0jrNd/PrOh34YP/0mCUO5Wj/D8Is+6Aj8cFnXg
f0mf0dKEuXo3IxWmCGKwjyBLnk3gTw0vnyObppES7rwTiAz9MOsITlDJDu0Dcnbj
TM/BARwYIBT4jcN8tbU4t4yyZBaD6ITS5bGYJvaWx1mKFU/j+yAYqufPi43BNmQL
OpHTIw6+KpqwELQfkjSd8SnX8OtOQeeaLytVxSdmSE6zsa2DZg08UCD6AND3s3pa
xB6AptOWRh2RohG57OM8XB5sqIQWVfRLizHyNaZBh6NHlImIU/JnE2714YoPGvus
HT1RLBKtf/FGhis7SO49hHL4hhBp/OOKyvHVYWGLSSfK4ZgToa2c+82lSqwZnHZc
2hTqk31xvPgoKbWoQGAS+oehGZIEt6iTeT0qaUwcCMclb/l6VMR+N2lZVyUv3f3S
sCuqasGBGWE5X6K2e0kzE+PrOEoADBefENbTavU3SUUFeGsFxl0GMXb3/9McxPya
p3vcpXpcjdmrr6aSRtndmQq6nnES1DIIYzpvUSi/28ZOzCurzAkZsl38zpbRMBLQ
JyRYHpyrIeMu/PlydBNx5O3Uuh9/O6jXUoQNjmwFhgBQvH6Y8y5RQNjAmF9CYqYH
9OKBeX6d1mHmTWGfdUYmI36ZrnRZq7HywfxDjN1EZc4ycS/fKONb1xJmZbe0bowk
7ES2X5GUeRebs59nd38g
=vbAj
-----END PGP SIGNATURE-----

--wac7ysb48OaltWcw--
