Path: news.gmane.org!not-for-mail
From: Felipe Balbi <balbi-l0cyMroinI0@public.gmane.org>
Newsgroups: gmane.linux.usb.general,gmane.linux.kernel,gmane.linux.drivers.devicetree
Subject: Re: [PATCH 1/2 v3] USB: dwc3-exynos: Add support for device tree
Date: Fri, 20 Jul 2012 12:49:54 +0300
Lines: 104
Approved: news@gmane.org
Message-ID: <20120720094953.GF24414@arwen.pp.htv.fi>
References: <1342418259-23802-1-git-send-email-gautam.vivek@samsung.com>
 <1342418259-23802-2-git-send-email-gautam.vivek@samsung.com>
Reply-To: balbi-l0cyMroinI0@public.gmane.org
NNTP-Posting-Host: plane.gmane.org
Mime-Version: 1.0
Content-Type: multipart/signed; micalg=pgp-sha1;
	protocol="application/pgp-signature"; boundary="UKNXkkdQCYZ6W5l3"
X-Trace: dough.gmane.org 1342777987 31171 80.91.229.3 (20 Jul 2012 09:53:07 GMT)
X-Complaints-To: usenet@dough.gmane.org
NNTP-Posting-Date: Fri, 20 Jul 2012 09:53:07 +0000 (UTC)
Cc: stern-nwvwT67g6+6dFdvTe/nMLpVzexx5G7lz@public.gmane.org, linux-usb-u79uwXL29TY76Z2rM5mHXA@public.gmane.org,
	linux-kernel-u79uwXL29TY76Z2rM5mHXA@public.gmane.org, devicetree-discuss-uLR06cmDAlY/bJ5BZ2RsiQ@public.gmane.org,
	l.majewski-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org, a.kesavan-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org,
	prashanth.g-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org, kmpark-wEGCiKHe2LqWVfeAwA7xHQ@public.gmane.org, joshi-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org,
	olofj-hpIqsD4AKlfQT0dZR+AlfA@public.gmane.org, thomas.abraham-QSEj5FYQhm4dnm+yROfE0A@public.gmane.org, sshtylyov-Igf4POYTYCDQT0dZR+AlfA@public.gmane.org,
	av.tikhomirov-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org
To: Vivek Gautam <gautam.vivek-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org>
Original-X-From: linux-usb-owner-u79uwXL29TY76Z2rM5mHXA@public.gmane.org Fri Jul 20 11:53:04 2012
Return-path: <linux-usb-owner-u79uwXL29TY76Z2rM5mHXA@public.gmane.org>
Envelope-to: glug-linux-usb-wOFGN7rlS/M9smdsby/KFg@public.gmane.org
Original-Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <linux-usb-owner-u79uwXL29TY76Z2rM5mHXA@public.gmane.org>)
	id 1Ss9tP-0000JJ-DJ
	for glug-linux-usb-wOFGN7rlS/M9smdsby/KFg@public.gmane.org; Fri, 20 Jul 2012 11:53:03 +0200
Original-Received: (majordomo-u79uwXL29TY76Z2rM5mHXA@public.gmane.org) by vger.kernel.org via listexpand
	id S1753248Ab2GTJxA (ORCPT <rfc822;glug-linux-usb@m.gmane.org>);
	Fri, 20 Jul 2012 05:53:00 -0400
Original-Received: from na3sys009aog121.obsmtp.com ([74.125.149.145]:47965 "EHLO
	na3sys009aog121.obsmtp.com" rhost-flags-OK-OK-OK-OK)
	by vger.kernel.org with ESMTP id S1753224Ab2GTJw7 (ORCPT
	<rfc822;linux-usb-u79uwXL29TY76Z2rM5mHXA@public.gmane.org>); Fri, 20 Jul 2012 05:52:59 -0400
Original-Received: from mail-lb0-f182.google.com ([209.85.217.182]) (using TLSv1) by na3sys009aob121.postini.com ([74.125.148.12]) with SMTP
	ID DSNKUAkqesT16Egq8cuL7+znn6pA9a9NY8o1-H7MdHJN5OvBBDgjK7y7TUQ@public.gmane.org; Fri, 20 Jul 2012 02:52:59 PDT
Original-Received: by lbon10 with SMTP id n10so8714124lbo.27
        for <linux-usb-u79uwXL29TY76Z2rM5mHXA@public.gmane.org>; Fri, 20 Jul 2012 02:52:55 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=google.com; s=20120113;
        h=date:from:to:cc:subject:message-id:reply-to:references:mime-version
         :content-type:content-disposition:in-reply-to:user-agent
         :x-gm-message-state;
        bh=ayuGPVUAhD3hIftPBJYwHbvG4o8WWMDKlh3rPMUHjUk=;
        b=F5s7h04S6Js6ElI6lYKbA+M/NnNs/zouZtZ5vqe7QJFtAWBOGQ6mp0h+QcLc/qFkee
         oMuNakThaMcReRkIr35WNXsiVZorOi5wxxCnPfKP/OhSc0c2jj1gqVK2yn+w+3VA5qLY
         TpouQFYW63qtVAHH50YbX/yrY6eyBdhNOEZvWTghLmHHgjjQe8+V+5+S1FZ/92Neekkh
         2rc0GFtW9I0zIIiMdxEa5FlkO5aoCOT8pPh+hNGPMiYos+StMYYHBV3oym/Ene9ixn7Y
         gMDVd/+VvWwWsyd30mYrkxDDfPhxsvKGo3iaITFWi130uIEH9CtJnzOjt+HnuG5s7UQH
         Z6mg==
Original-Received: by 10.152.102.137 with SMTP id fo9mr5562939lab.35.1342777975532;
        Fri, 20 Jul 2012 02:52:55 -0700 (PDT)
Original-Received: from localhost (cs78217178.pp.htv.fi. [62.78.217.178])
        by mx.google.com with ESMTPS id fy10sm4478867lab.0.2012.07.20.02.52.53
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 20 Jul 2012 02:52:54 -0700 (PDT)
Content-Disposition: inline
In-Reply-To: <1342418259-23802-2-git-send-email-gautam.vivek-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org>
User-Agent: Mutt/1.5.21 (2010-09-15)
X-Gm-Message-State: ALoCoQmayZg/+THbw0cBf1xQMCzGGxKaUw6NzynYEorvoqd1AtYs/TwDslc6/7Wu15o/1qR7K2Qw
Original-Sender: linux-usb-owner-u79uwXL29TY76Z2rM5mHXA@public.gmane.org
Precedence: bulk
List-ID: <linux-usb.vger.kernel.org>
X-Mailing-List: linux-usb-u79uwXL29TY76Z2rM5mHXA@public.gmane.org
Xref: news.gmane.org gmane.linux.usb.general:68000 gmane.linux.kernel:1330760 gmane.linux.drivers.devicetree:18403
Archived-At: <http://permalink.gmane.org/gmane.linux.kernel/1330760>


--UKNXkkdQCYZ6W5l3
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
Content-Transfer-Encoding: quoted-printable

Hi,

On Mon, Jul 16, 2012 at 11:27:38AM +0530, Vivek Gautam wrote:
> This patch adds support to parse probe data for
> dwc3 driver for exynos using device tree
>=20
> Signed-off-by: Praveen Paneri <p.paneri-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org>
> Signed-off-by: Vivek Gautam <gautam.vivek-Sze3O3UU22JBDgjK7y7TUQ@public.gmane.org>
> ---
>  drivers/usb/dwc3/dwc3-exynos.c |   22 ++++++++++++++++++++++
>  1 files changed, 22 insertions(+), 0 deletions(-)
>=20
> diff --git a/drivers/usb/dwc3/dwc3-exynos.c b/drivers/usb/dwc3/dwc3-exyno=
s.c
> index b8f0038..a293c69 100644
> --- a/drivers/usb/dwc3/dwc3-exynos.c
> +++ b/drivers/usb/dwc3/dwc3-exynos.c
> @@ -19,6 +19,7 @@
>  #include <linux/platform_data/dwc3-exynos.h>
>  #include <linux/dma-mapping.h>
>  #include <linux/clk.h>
> +#include <linux/of.h>
> =20
>  #include "core.h"
> =20
> @@ -29,6 +30,8 @@ struct dwc3_exynos {
>  	struct clk		*clk;
>  };
> =20
> +static u64 dwc3_exynos_dma_mask =3D DMA_BIT_MASK(32);
> +
>  static int __devinit dwc3_exynos_probe(struct platform_device *pdev)
>  {
>  	struct dwc3_exynos_data	*pdata =3D pdev->dev.platform_data;
> @@ -45,6 +48,16 @@ static int __devinit dwc3_exynos_probe(struct platform=
_device *pdev)
>  		goto err0;
>  	}
> =20
> +	/*
> +	 * Right now device-tree probed devices don't get dma_mask set.
> +	 * Since shared usb code relies on it, set it here for now.
> +	 * Once we move to full device tree support this will vanish off.
> +	 */
> +	if (!pdev->dev.dma_mask)
> +		pdev->dev.dma_mask =3D &dwc3_exynos_dma_mask;
> +	if (!pdev->dev.coherent_dma_mask)
> +		pdev->dev.coherent_dma_mask =3D DMA_BIT_MASK(32);
> +
>  	platform_set_drvdata(pdev, exynos);
> =20
>  	devid =3D dwc3_get_device_id();
> @@ -134,11 +147,20 @@ static int __devexit dwc3_exynos_remove(struct plat=
form_device *pdev)
>  	return 0;
>  }
> =20
> +#ifdef CONFIG_OF
> +static const struct of_device_id exynos_xhci_match[] =3D {
> +	{ .compatible =3D "samsung,exynos-xhci" },
> +	{},
> +};
> +MODULE_DEVICE_TABLE(of, exynos_xhci_match);

this is not an xhci device. It contains one inside of it, but it's not
an xhci device.

--=20
balbi

--UKNXkkdQCYZ6W5l3
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: Digital signature

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQIcBAEBAgAGBQJQCSnBAAoJEIaOsuA1yqREoRUP/At/inO013H0bVrld9rE0pnv
/hqDtw2eHzawN+ozDV6xvEfWYwVIT0sXDv2ces0WoSyP79kKu84UeX2JNR23c6E6
QfONYP3YpG8W4oi3JhSxXBZVJY2AsIJcU2dETj9vT1CCLrjoz5dgC4Op+Lk9g/T7
cmtIqlyVbWaY5Uyt4umqw/Ic+8K6CglHXeCBYSz4RU/d/68A24iUFYF7xDWjE07F
zP0UCu2xC4Uo0PcT8Oo2py7tzmdWcw/p+v0E4wqoLAWoqhouZJCqvYlTv4SCP/AF
kOXgB/jtR4hw9irKJ4w6jiFCa4j2Npfo8wcEiUrlhlSOK0DTw5n+x80G2PM5sdw8
HVRxHc3q2vm6iusLBexKaO9J+gmfWkdLnbS7Hx6t24Kyy9OFwlmQISIQQwsc1gTy
UiEAYYceYmLvqUgtFgsgEi3LsnRY163IFrViyx8ulZubZRkAjEEgNUOp4bp+B+sZ
lTunSzDvnThMIIbLyTr9yk5R7fK8hyqvnO8Ru+oi/sET02KNDWqxNb3UsGbPNWcs
TkPz8tj/Kmyo2Z4qa3zD+KV/WeEMN5uma3uT0PwWiX4cDpv284EfVjms4WOuEb8v
r5T19nemSLlo+RJ34TLncvmTJkpyZfrJa+l8dtTAUYDIV86noxK2oUVLEytaeUdy
fqTtWyqH6pbLVPpV/gUQ
=zisS
-----END PGP SIGNATURE-----

--UKNXkkdQCYZ6W5l3--
--
To unsubscribe from this list: send the line "unsubscribe linux-usb" in
the body of a message to majordomo-u79uwXL29TY76Z2rM5mHXA@public.gmane.org
More majordomo info at  http://vger.kernel.org/majordomo-info.html

