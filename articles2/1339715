Path: news.gmane.org!not-for-mail
From: Kukjin Kim <kgene.kim@samsung.com>
Newsgroups: gmane.linux.kernel.samsung-soc,gmane.linux.kernel
Subject: RE: [PATCH] ARM: SAMSUNG: Fix compilation error with s3c2410_defconfig
Date: Wed, 08 Aug 2012 09:54:13 +0900
Lines: 226
Approved: news@gmane.org
Message-ID: <0a2d01cd7500$53e26c50$fba744f0$%kim@samsung.com>
References: <1344333546-16995-1-git-send-email-tushar.behera@linaro.org>
 <098f01cd7488$0d66d630$28348290$%kim@samsung.com> <5020F568.5020204@linaro.org>
NNTP-Posting-Host: plane.gmane.org
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Trace: dough.gmane.org 1344387260 7432 80.91.229.3 (8 Aug 2012 00:54:20 GMT)
X-Complaints-To: usenet@dough.gmane.org
NNTP-Posting-Date: Wed, 8 Aug 2012 00:54:20 +0000 (UTC)
Cc: linux-samsung-soc@vger.kernel.org, linux-kernel@vger.kernel.org,
	s.hauer@pengutronix.de, patches@linaro.org
To: 'Tushar Behera' <tushar.behera@linaro.org>,
	thierry.reding@avionic-design.de
Original-X-From: linux-samsung-soc-owner@vger.kernel.org Wed Aug 08 02:54:19 2012
Return-path: <linux-samsung-soc-owner@vger.kernel.org>
Envelope-to: glks-linux-samsung-soc@plane.gmane.org
Original-Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <linux-samsung-soc-owner@vger.kernel.org>)
	id 1SyuXS-0007oH-OT
	for glks-linux-samsung-soc@plane.gmane.org; Wed, 08 Aug 2012 02:54:19 +0200
Original-Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1753209Ab2HHAyQ (ORCPT
	<rfc822;glks-linux-samsung-soc@m.gmane.org>);
	Tue, 7 Aug 2012 20:54:16 -0400
Original-Received: from mailout3.samsung.com ([203.254.224.33]:31614 "EHLO
	mailout3.samsung.com" rhost-flags-OK-OK-OK-OK) by vger.kernel.org
	with ESMTP id S1753290Ab2HHAyP (ORCPT
	<rfc822;linux-samsung-soc@vger.kernel.org>);
	Tue, 7 Aug 2012 20:54:15 -0400
Original-Received: from epcpsbgm2.samsung.com (mailout3.samsung.com [203.254.224.33])
 by mailout3.samsung.com
 (Oracle Communications Messaging Server 7u4-24.01(7.0.4.24.0) 64bit (built Nov
 17 2011)) with ESMTP id <0M8E009T3VTIXG90@mailout3.samsung.com>; Wed,
 08 Aug 2012 09:54:13 +0900 (KST)
X-AuditID: cbfee61b-b7f566d000005c8a-b6-5021b8b54dd0
Original-Received: from epmmp1.local.host ( [203.254.227.16])
	by epcpsbgm2.samsung.com (EPCPMTA) with SMTP id E8.C8.23690.5B8B1205; Wed,
 08 Aug 2012 09:54:13 +0900 (KST)
Original-Received: from DOKGENEKIM03 ([12.23.119.152])
 by mmp1.samsung.com (Oracle Communications Messaging Server 7u4-24.01
 (7.0.4.24.0) 64bit (built Nov 17 2011))
 with ESMTPA id <0M8E001FZVUDHB30@mmp1.samsung.com>; Wed,
 08 Aug 2012 09:54:13 +0900 (KST)
In-reply-to: <5020F568.5020204@linaro.org>
X-Mailer: Microsoft Office Outlook 12.0
Thread-index: Ac10i/Ch62t3OukGTm260i7w2w6O+gActU3Q
Content-language: ko
X-Brightmail-Tracker: H4sIAAAAAAAAA+NgFrrILMWRmVeSWpSXmKPExsVy+t9jAd2tOxQDDK7cELW4vGsOm8WM8/uY
	HJg8Pm+SC2CM4rJJSc3JLEst0rdL4Mr4cLibqeChRcXxZXtYGhjX6HUxcnJICJhIrG5cxAxh
	i0lcuLeerYuRi0NIYBGjxNHrM5ghnL+MEqf+vmAFqWIT0JA4/P4ZO4gtIhAgsezEK7A4s0Ch
	xOmjUxkhGmYxSjTsfAs0ioODU0BL4sZ3XxBTWMBf4lFnAUg5i4CqxIsTB8FaeQVsJboe/WCE
	sAUlfky+xwIxUkti/c7jTBC2vMTmNW+ZQcZICKhLPPqrC3GBkcT0N8eZIUpEJPa9eMc4gVFo
	FpJJs5BMmoVk0iwkLQsYWVYxiqYWJBcUJ6XnGukVJ+YWl+al6yXn525iBAf0M+kdjKsaLA4x
	CnAwKvHwbkpVDBBiTSwrrsw9xCjBwawkwtvWChTiTUmsrEotyo8vKs1JLT7EKM3BoiTOa+L9
	1V9IID2xJDU7NbUgtQgmy8TBKdXAyLMwf1lTz8w1eiwBTd6f7Vwrfs/eu/VXPEvXo3pJ2Syr
	Z+cidjpcWb5u0+zytTdUNwdvtH1cbMyrfSHNZHH5Lu6m1RtL7x7Usp8gU2qjsZjXhOX/7ToG
	gxVLWqyYZeI/T5IIOOchxSTDtucTX4XwRnv7uz/S73v68kc9vNd0pHvT/5elJY9fKLEUZyQa
	ajEXFScCABDajvFkAgAA
X-TM-AS-MML: No
Original-Sender: linux-samsung-soc-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-samsung-soc.vger.kernel.org>
X-Mailing-List: linux-samsung-soc@vger.kernel.org
Xref: news.gmane.org gmane.linux.kernel.samsung-soc:11998 gmane.linux.kernel:1339715
Archived-At: <http://permalink.gmane.org/gmane.linux.kernel/1339715>

Tushar Behera wrote:
> 
> On 08/07/2012 04:03 PM, Kukjin Kim wrote:
> > Tushar Behera wrote:
> >>
> >> Commit 2663e766c56a "ARM Samsung: Move s3c pwm driver to pwm framework"
> >> moved Samsung PWM driver to drivers/pwm and the config option to select
> >> this driver has changed.
> >>
> >> This patch fixes following build-error with s3c2410_defconfig.
> >> arch/arm/mach-s3c24xx/mach-rx1950.c:430: undefined reference to
> >> `pwm_config'
> >>
> >
> > Yes, need to fix...
> >
> > arch/arm/mach-s3c24xx/built-in.o: In function `rx1950_lcd_power':
> > arch/arm/mach-s3c24xx/mach-rx1950.c:430: undefined reference to
> `pwm_config'
> > arch/arm/mach-s3c24xx/mach-rx1950.c:431: undefined reference to
> > `pwm_disable'
> > arch/arm/mach-s3c24xx/mach-rx1950.c:437: undefined reference to
> `pwm_config'
> > arch/arm/mach-s3c24xx/mach-rx1950.c:438: undefined reference to
> `pwm_enable'
> > arch/arm/mach-s3c24xx/built-in.o: In function `rx1950_backlight_exit':
> > arch/arm/mach-s3c24xx/mach-rx1950.c:504: undefined reference to
> `pwm_free'
> > arch/arm/mach-s3c24xx/built-in.o: In function `rx1950_backlight_init':
> > arch/arm/mach-s3c24xx/mach-rx1950.c:487: undefined reference to
> > `pwm_request'
> >
> 
> Yes, the patch fixes all of these errors, didn't include them in the
> patch comments though as they were all similar.
> 
I will add above description when I apply this :)

> 
> >> Signed-off-by: Tushar Behera <tushar.behera@linaro.org>
> >> ---
> >>  arch/arm/mach-s3c24xx/Kconfig |    4 ++--
> >>  arch/arm/plat-samsung/Kconfig |    3 ++-
> >>  2 files changed, 4 insertions(+), 3 deletions(-)
> >>
> >> diff --git a/arch/arm/mach-s3c24xx/Kconfig b/arch/arm/mach-
> s3c24xx/Kconfig
> >> index e249611..d56b0f7 100644
> >> --- a/arch/arm/mach-s3c24xx/Kconfig
> >> +++ b/arch/arm/mach-s3c24xx/Kconfig
> >> @@ -483,7 +483,7 @@ config MACH_NEO1973_GTA02
> >>  	select I2C
> >>  	select POWER_SUPPLY
> >>  	select MACH_NEO1973
> >> -	select S3C2410_PWM
> >> +	select S3C24XX_PWM
> 
> The above needs to be picked up as S3C2410_PWM is no longer defined.
> 
Correct, I know. In addition, I'd preferred to use SAMSUNG_PWM so I will
change the name later.

> >>  	select S3C_DEV_USB_HOST
> >>  	help
> >>  	   Say Y here if you are using the Openmoko GTA02 / Freerunner GSM
> >> Phone
> >> @@ -493,7 +493,7 @@ config MACH_RX1950
> >>  	select S3C24XX_DCLK
> >>  	select PM_H1940 if PM
> >>  	select I2C
> >> -	select S3C2410_PWM
> >> +	select S3C24XX_PWM
> 
> Same as above.
> 
> >>  	select S3C_DEV_NAND
> >>  	select S3C2410_IOTIMING if S3C2440_CPUFREQ
> >>  	select S3C2440_XTAL_16934400
> >> diff --git a/arch/arm/plat-samsung/Kconfig b/arch/arm/plat-
> samsung/Kconfig
> >> index 7aca31c..9c3b90c 100644
> >> --- a/arch/arm/plat-samsung/Kconfig
> >> +++ b/arch/arm/plat-samsung/Kconfig
> >> @@ -403,7 +403,8 @@ config S5P_DEV_USB_EHCI
> >>
> >>  config S3C24XX_PWM
> >>  	bool "PWM device support"
> >> -	select HAVE_PWM
> >> +	select PWM
> >> +	select PWM_SAMSUNG
> >>  	help
> >>  	  Support for exporting the PWM timer blocks via the pwm device
> >>  	  system
> >> --
> >> 1.7.4.1
> >
> > I think, following would be better? Or ...
> >
> 
> No issues. You can pick whichever you find better.
> 
Thanks, see below.

> > ---
> > diff --git a/arch/arm/plat-samsung/Kconfig b/arch/arm/plat-
> samsung/Kconfig
> > index 7aca31c..dcdfb77 100644
> > --- a/arch/arm/plat-samsung/Kconfig
> > +++ b/arch/arm/plat-samsung/Kconfig
> > @@ -403,7 +403,7 @@ config S5P_DEV_USB_EHCI
> >
> >  config S3C24XX_PWM
> >  	bool "PWM device support"
> > -	select HAVE_PWM
> > +	select PWM
> >  	help
> >  	  Support for exporting the PWM timer blocks via the pwm device
> >  	  system
> > diff --git a/drivers/pwm/Kconfig b/drivers/pwm/Kconfig
> > index 8fc3808..34c8ec1 100644
> > --- a/drivers/pwm/Kconfig
> > +++ b/drivers/pwm/Kconfig
> > @@ -59,7 +59,7 @@ config PWM_PXA
> >
> >  config PWM_SAMSUNG
> >  	tristate "Samsung pwm support"
> > -	depends on PLAT_SAMSUNG
> > +	def_bool PLAT_SAMSUNG
> >  	help
> >  	  Generic PWM framework driver for Samsung.
> > ---
> >
> >

From: Tushar Behera <tushar.behera@linaro.org>
Subject: [PATCH] ARM: SAMSUNG: Fix compilation error with s3c2410_defconfig

Commit 2663e766c56a ("ARM Samsung: Move s3c pwm driver to pwm framework")
moved Samsung PWM driver to drivers/pwm and the config option to select
this driver has changed.

This patch fixes following build-error with s3c2410_defconfig.

arch/arm/mach-s3c24xx/built-in.o: In function 'rx1950_lcd_power':
arch/arm/mach-s3c24xx/mach-rx1950.c:430: undefined reference to 'pwm_config'
arch/arm/mach-s3c24xx/mach-rx1950.c:431: undefined reference to
'pwm_disable'
arch/arm/mach-s3c24xx/mach-rx1950.c:437: undefined reference to 'pwm_config'
arch/arm/mach-s3c24xx/mach-rx1950.c:438: undefined reference to 'pwm_enable'
arch/arm/mach-s3c24xx/built-in.o: In function 'rx1950_backlight_exit':
arch/arm/mach-s3c24xx/mach-rx1950.c:504: undefined reference to 'pwm_free'
arch/arm/mach-s3c24xx/built-in.o: In function 'rx1950_backlight_init':
arch/arm/mach-s3c24xx/mach-rx1950.c:487: undefined reference to
'pwm_request'

Signed-off-by: Tushar Behera <tushar.behera@linaro.org>
[kgene.kim@samsung.com: re-worked as per review comments]
Cc: Thierry Reding <thierry.reding@avionic-design.de>
Signed-off-by: Kukjin Kim <kgene.kim@samsung.com>
---
 arch/arm/mach-s3c24xx/Kconfig |    4 ++--
 arch/arm/plat-samsung/Kconfig |    2 +-
 drivers/pwm/Kconfig           |    2 +-
 3 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/arch/arm/mach-s3c24xx/Kconfig b/arch/arm/mach-s3c24xx/Kconfig
index e249611..d56b0f7 100644
--- a/arch/arm/mach-s3c24xx/Kconfig
+++ b/arch/arm/mach-s3c24xx/Kconfig
@@ -483,7 +483,7 @@ config MACH_NEO1973_GTA02
 	select I2C
 	select POWER_SUPPLY
 	select MACH_NEO1973
-	select S3C2410_PWM
+	select S3C24XX_PWM
 	select S3C_DEV_USB_HOST
 	help
 	   Say Y here if you are using the Openmoko GTA02 / Freerunner GSM
Phone
@@ -493,7 +493,7 @@ config MACH_RX1950
 	select S3C24XX_DCLK
 	select PM_H1940 if PM
 	select I2C
-	select S3C2410_PWM
+	select S3C24XX_PWM
 	select S3C_DEV_NAND
 	select S3C2410_IOTIMING if S3C2440_CPUFREQ
 	select S3C2440_XTAL_16934400
diff --git a/arch/arm/plat-samsung/Kconfig b/arch/arm/plat-samsung/Kconfig
index 7aca31c..dcdfb77 100644
--- a/arch/arm/plat-samsung/Kconfig
+++ b/arch/arm/plat-samsung/Kconfig
@@ -403,7 +403,7 @@ config S5P_DEV_USB_EHCI
 
 config S3C24XX_PWM
 	bool "PWM device support"
-	select HAVE_PWM
+	select PWM
 	help
 	  Support for exporting the PWM timer blocks via the pwm device
 	  system
diff --git a/drivers/pwm/Kconfig b/drivers/pwm/Kconfig
index 8fc3808..34c8ec1 100644
--- a/drivers/pwm/Kconfig
+++ b/drivers/pwm/Kconfig
@@ -59,7 +59,7 @@ config PWM_PXA
 
 config PWM_SAMSUNG
 	tristate "Samsung pwm support"
-	depends on PLAT_SAMSUNG
+	def_bool PLAT_SAMSUNG
 	help
 	  Generic PWM framework driver for Samsung.
 
-- 
1.7.4.1


Thanks.

Best regards,
Kgene.
--
Kukjin Kim <kgene.kim@samsung.com>, Senior Engineer,
SW Solution Development Team, Samsung Electronics Co., Ltd.

