Path: news.gmane.org!not-for-mail
From: Mark Brown <broonie@opensource.wolfsonmicro.com>
Newsgroups: gmane.linux.kernel
Subject: Re: [PATCH] wm831x-dcdc: fix coccinelle warnings of missing
 IRQF_ONESHOT
Date: Fri, 10 Aug 2012 11:04:57 +0100
Lines: 18
Approved: news@gmane.org
Message-ID: <20120810100456.GF24328@opensource.wolfsonmicro.com>
References: <1344560304-4322-1-git-send-email-feng.tang@intel.com>
NNTP-Posting-Host: plane.gmane.org
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
X-Trace: dough.gmane.org 1344593111 18486 80.91.229.3 (10 Aug 2012 10:05:11 GMT)
X-Complaints-To: usenet@dough.gmane.org
NNTP-Posting-Date: Fri, 10 Aug 2012 10:05:11 +0000 (UTC)
Cc: Axel Lin <axel.lin@gmail.com>, linux-kernel@vger.kernel.org,
	Fengguang Wu <fengguang.wu@intel.com>
To: Feng Tang <feng.tang@intel.com>
Original-X-From: linux-kernel-owner@vger.kernel.org Fri Aug 10 12:05:11 2012
Return-path: <linux-kernel-owner@vger.kernel.org>
Envelope-to: glk-linux-kernel-3@plane.gmane.org
Original-Received: from vger.kernel.org ([209.132.180.67])
	by plane.gmane.org with esmtp (Exim 4.69)
	(envelope-from <linux-kernel-owner@vger.kernel.org>)
	id 1Szm5b-000057-83
	for glk-linux-kernel-3@plane.gmane.org; Fri, 10 Aug 2012 12:05:07 +0200
Original-Received: (majordomo@vger.kernel.org) by vger.kernel.org via listexpand
	id S1759887Ab2HJKFB (ORCPT <rfc822;glk-linux-kernel-3@m.gmane.org>);
	Fri, 10 Aug 2012 06:05:01 -0400
Original-Received: from opensource.wolfsonmicro.com ([80.75.67.52]:56528 "EHLO
	opensource.wolfsonmicro.com" rhost-flags-OK-OK-OK-OK)
	by vger.kernel.org with ESMTP id S1759670Ab2HJKE7 (ORCPT
	<rfc822;linux-kernel@vger.kernel.org>);
	Fri, 10 Aug 2012 06:04:59 -0400
Original-Received: from finisterre.wolfsonmicro.main (unknown [87.246.78.26])
	by opensource.wolfsonmicro.com (Postfix) with ESMTPSA id 0027C750040;
	Fri, 10 Aug 2012 11:04:57 +0100 (BST)
Original-Received: from broonie by finisterre.wolfsonmicro.main with local (Exim 4.80)
	(envelope-from <broonie@opensource.wolfsonmicro.com>)
	id 1Szm5R-0005oZ-Az; Fri, 10 Aug 2012 11:04:57 +0100
Content-Disposition: inline
In-Reply-To: <1344560304-4322-1-git-send-email-feng.tang@intel.com>
X-Cookie: Be different: conform.
User-Agent: Mutt/1.5.21 (2010-09-15)
Original-Sender: linux-kernel-owner@vger.kernel.org
Precedence: bulk
List-ID: <linux-kernel.vger.kernel.org>
X-Mailing-List: linux-kernel@vger.kernel.org
Xref: news.gmane.org gmane.linux.kernel:1341219
Archived-At: <http://permalink.gmane.org/gmane.linux.kernel/1341219>

On Fri, Aug 10, 2012 at 08:58:24AM +0800, Feng Tang wrote:
> From: Fengguang Wu <fengguang.wu@intel.com>
> 
> /c/kernel-tests/src/linux/drivers/regulator/wm831x-dcdc.c:829:7-27: ERROR: Threaded IRQ with no primary handler requested without IRQF_ONESHOT
> /c/kernel-tests/src/linux/drivers/regulator/wm831x-dcdc.c:695:7-27: ERROR: Threaded IRQ with no primary handler requested without IRQF_ONESHOT
> /c/kernel-tests/src/linux/drivers/regulator/wm831x-dcdc.c:533:7-27: ERROR: Threaded IRQ with no primary handler requested without IRQF_ONESHOT
> /c/kernel-tests/src/linux/drivers/regulator/wm831x-dcdc.c:542:7-27: ERROR: Threaded IRQ with no primary handler requested without IRQF_ONESHOT

> Generated by: scripts/coccinelle/misc/irqf_oneshot.cocci

>  Make sure threaded IRQs without a primary handler are always request with
>  IRQF_ONESHOT

This is actually a false positive - _ONESHOT is only needed for
interrupts without a primary handler if the interrupt controller is not
threaded.  For this driver (and most of the other wm831x drivers, as
well as many other MFDs) we are guaranteed that the primary handler can
never be called.  It's not going to hurt, though.
